# 월부 학습 관리 앱

## 1. 구현 범위에 대한 설명

1. **회원 정보를 입력받아 저장**하는 API
   - 파라미터 검증(empty 여부, 휴대폰 형식, 비밀번호 형식)
   - 이메일 중복 검증
2. **이메일, 비밀번호를 입력받아 로그인하고 액세스 토큰을 발급**하는 API
   - 액세스 토큰 만료 시 리프레시 토큰으로 재발급
   - 액세스토큰 만료 시간 1시간, 리프레시 토큰 만료 시간 10시간
3. **강의 개설을 위한 정보를 입력받아 저장**하는 API
   - 회원 유형에 따라 기능 실행 권한을 제한
4. **강의 목록을 조회**하는 API
   - 페이지네이션 및 정렬 기능(최근 등록 순, 신청자 많은 순, 신청률 높은 순)
   - 정렬 조건
     - 최근 등록 순 : CREATED_DATE_TIME
     - 신청자 많은 순 : REGISTRATION_COUNT
     - 신청률 높은 순 : REGISTRATION_RATE
   - 조회 예시
       - /courses?page=0&size=2&sort=CREATED_DATE_TIME,desc : 첫번째 페이지, 개수 2개, 최근 등록 순, 내림차순
5. **강의 아이디 리스트를 입력받아 수강신청**하는 API
   - 단일스레드로 동작하는 성질을 가진 redis 사용
   - 많은 사람이 동시 신청 시에도 최대 수강 인원만큼만 처리

## 2. 코드 빌드, 테스트, 실행 방법

### 요구사항
- Java 17 이상
- Gradle 7.3 이상
- h2 database
- docker

### Build

프로젝트를 빌드 명령은 다음과 같습니다.

```bash
./gradlew build
```

### Test

단위 테스트를 실행 명령은 다음과 같습니다.

```bash
./gradlew test
```

### Run

애플리케이션을 실행 명령은 다음과 같습니다.
1. 프로젝트 폴더 이동
2. docker-compose 명령 수행하여 redis 실행
3. gradle 사용하여 어플리케이션 실행

```bash
docker-compose up -d
./gradlew bootRun
```

## 기타 접속정보

1. H2 콘솔 접속
    - http://localhost:8080/h2-console
    - 애플리케이션이 시작될 때 H2 인메모리 데이터베이스가 data.sql 파일을 실행하여 자동으로 초기화합니다.
2. API 문서
    - http://localhost:8080/swagger-ui/index.html

## 추가 구현 내용

1. Unit test 및 Integration test 작성
    - 비즈니스 영역 테스트 커버리지 100% 수행
2. 전역 예외 핸들링

## 핵심 문제해결 전략과 설계의 이유
### 분산락 사용한 동시성 처리
1. 데이터 무결성 보장
    - 분산락을 통해 여러 클라이언트가 동시에 동일한 데이터에 접근하는 것을 방지할 수 있습니다. 이를 통해 데이터의 일관성과 무결성을 유지할 수 있습니다.
2. 확장성 향상
   - 분산 환경에서 동시성 제어를 통해 시스템의 확장성을 높일 수 있습니다.
   여러 노드에서 동시에 데이터를 처리할 수 있기 때문에 시스템의 처리 능력을 향상시킬 수 있습니다.

### Entity 설계 시 mappedSuperclass 사용
1. 코드 재사용성 향상
   - 시간 관련 정보(생성일, 수정일 등)를 상위 클래스에서 관리하면 하위 클래스에서 이를 재사용할 수 있습니다. 이를 통해 중복 코드를 줄이고 유지보수성을 높일 수 있습니다. 
2. 일관성 유지
   - 모든 엔티티에서 시간 관련 정보를 일관되게 관리할 수 있습니다. 이를 통해 데이터의 무결성과 신뢰성을 높일 수 있습니다. 
3. 확장성 향상
   - 시간 관련 정보를 관리하는 로직을 상위 클래스에서 관리하면, 하위 클래스에서 이를 쉽게 확장할 수 있습니다. 예를 들어, 시간 정보에 대한 추가 필드 또는 로직을 추가할 때 상위 클래스만 수정하면 됩니다.

### QueryDSL 사용
1. 유형 안전성
   - Querydsl은 컴파일 시간에 쿼리의 유효성을 검사할 수 있어 런타임 오류를 방지할 수 있습니다. 이를 통해 더 안전하고 유지보수 가능한 코드를 작성할 수 있습니다. 
2. 재사용성
   - Querydsl을 통해 작성된 쿼리는 재사용이 쉽습니다. 이를 통해 중복된 코드를 줄일 수 있고, 일관성 있는 쿼리 작성이 가능합니다. 
3. IDE 지원
   - Querydsl은 Eclipse, IntelliJ IDEA 등의 IDE에서 자동 완성, 리팩토링 등의 기능을 지원하여 개발 생산성을 높일 수 있습니다. 
4. 다양한 데이터베이스 지원
   - Querydsl은 다양한 데이터베이스(MySQL, PostgreSQL, Oracle, SQL Server 등)를 지원하므로, 데이터베이스 변경 시에도 쿼리 작성 방식을 크게 변경할 필요가 없습니다. 
5. 복잡한 쿼리 작성 용이
   - Querydsl은 동적 쿼리 작성, 서브쿼리 처리, 조인 등 복잡한 쿼리 작성을 쉽게 할 수 있습니다. 
6. 가독성 향상
   - Querydsl을 사용하면 SQL 쿼리를 Java 코드로 작성할 수 있어, 가독성이 높아집니다.

